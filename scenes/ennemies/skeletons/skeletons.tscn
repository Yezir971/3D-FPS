[gd_scene load_steps=9 format=3 uid="uid://cn6jpuy3tmp4y"]

[ext_resource type="PackedScene" uid="uid://cn24vkcx1xdvo" path="res://models/ennemies/skeleton/skeleton_mage.glb" id="1_3eyau"]
[ext_resource type="Script" uid="uid://gk3abf6fy0g3" path="res://script/skeletons.gd" id="1_oj6du"]
[ext_resource type="Script" uid="uid://dspnyi7bm6kea" path="res://scenes/ennemies/skeletons/character_body_3d_skeletons.gd" id="2_iq34d"]
[ext_resource type="Script" uid="uid://dqywrlc6wr6sf" path="res://script/progress_bar.gd" id="3_qiyck"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_3eyau"]
radius = 0.590591
height = 2.70843

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_lkm61"]

[sub_resource type="ViewportTexture" id="ViewportTexture_iq34d"]
viewport_path = NodePath("CharacterBody3D/skeleton_mage/SubViewport")

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_qiyck"]
radius = 0.534919
height = 2.36497

[node name="Skeletons" type="Node3D" groups=["enemies"]]
script = ExtResource("1_oj6du")

[node name="CharacterBody3D" type="CharacterBody3D" parent="." groups=["enemies"]]
script = ExtResource("2_iq34d")

[node name="skeleton_mage" parent="CharacterBody3D" groups=["enemies"] instance=ExtResource("1_3eyau")]

[node name="Skeleton3D" parent="CharacterBody3D/skeleton_mage/Rig" index="0"]
bones/1/position = Vector3(0.00841076, 0.378046, 1.21849e-10)
bones/2/rotation = Quaternion(-0.0605995, -0.130282, -0.00797808, 0.989591)
bones/3/rotation = Quaternion(-2.22045e-16, -3.57567e-09, -2.85747e-10, 1)
bones/3/scale = Vector3(1, 1, 1)
bones/4/position = Vector3(0.248044, 0.110857, 0.0825816)
bones/4/rotation = Quaternion(-0.577713, -0.249364, -0.73471, 0.253509)
bones/4/scale = Vector3(1, 0.999999, 1)
bones/5/rotation = Quaternion(2.57531e-08, -7.4026e-08, -0.550246, 0.835003)
bones/6/rotation = Quaternion(1.10745e-08, -5.13145e-13, 0.0266581, 0.999645)
bones/7/rotation = Quaternion(-0.195243, -0.672535, -0.0531652, 0.711864)
bones/8/position = Vector3(8.34836e-10, 0.0961252, -0.0575001)
bones/8/rotation = Quaternion(-6.29278e-09, 4.24393e-09, -0.707107, 0.707107)
bones/9/position = Vector3(-0.176682, 0.111703, 0.0891542)
bones/9/rotation = Quaternion(-0.248319, 0.341504, 0.842174, 0.335345)
bones/9/scale = Vector3(1, 0.999999, 1)
bones/10/rotation = Quaternion(1.54903e-08, 4.43594e-08, 0.573091, 0.819492)
bones/11/rotation = Quaternion(-7.94255e-09, -1.43988e-08, -0.0266581, 0.999645)
bones/12/rotation = Quaternion(-0.234584, 0.22343, -0.113618, 0.939223)
bones/13/position = Vector3(-8.34829e-10, 0.0961251, -0.0574999)
bones/13/rotation = Quaternion(0.155711, -0.189455, 0.670289, 0.700409)
bones/13/scale = Vector3(1, 1, 1)
bones/14/rotation = Quaternion(0.0854265, 0.130441, 0.00470451, 0.987758)
bones/16/position = Vector3(0.170945, 0.113587, 1.39233e-08)
bones/16/rotation = Quaternion(0.993728, 0.0733767, 0.0391868, 0.0747389)
bones/17/rotation = Quaternion(0.350238, 6.5134e-08, -2.45306e-07, 0.936661)
bones/18/rotation = Quaternion(-0.592131, -0.213501, 0.0538368, 0.775177)
bones/19/rotation = Quaternion(4.92663e-05, 0.92016, -0.391541, -1.11104e-05)
bones/20/rotation = Quaternion(0.991183, -0.0392424, -0.0117463, 0.126008)
bones/21/rotation = Quaternion(0.389035, -6.29368e-08, 2.68502e-07, 0.921223)
bones/22/rotation = Quaternion(-0.602857, 0.112087, -0.0280757, 0.789437)
bones/23/rotation = Quaternion(-2.55501e-05, 0.920165, -0.391531, 5.95206e-06)
bones/24/rotation = Quaternion(0.707107, -2.29302e-07, -4.60552e-08, 0.707107)
bones/25/rotation = Quaternion(-0.707107, -7.05285e-08, -7.05285e-08, 0.707107)
bones/26/position = Vector3(0.0308395, 0.382458, -2.86687e-15)
bones/26/rotation = Quaternion(1.00138e-08, 1.91522e-09, 0.984639, -0.174603)
bones/27/position = Vector3(3.75295e-09, 0.213436, -1.0343e-08)
bones/27/rotation = Quaternion(-9.99889e-08, 0.391084, 0.920355, -3.39507e-08)
bones/28/position = Vector3(2.3491e-08, 0.16565, -5.09136e-09)
bones/28/rotation = Quaternion(-0.391084, -6.59362e-08, -5.87716e-08, 0.920355)
bones/29/rotation = Quaternion(1, 2.30261e-09, 1.93335e-07, -4.39844e-16)
bones/30/rotation = Quaternion(-6.93878e-18, -9.55588e-16, -1.20164e-08, 1)
bones/31/rotation = Quaternion(0.707107, -3.82385e-08, 1.45009e-07, 0.707107)
bones/32/rotation = Quaternion(-0.707107, -7.05285e-08, -7.05285e-08, 0.707107)
bones/33/rotation = Quaternion(-5.83589e-09, 6.43837e-10, 0.994809, 0.101756)
bones/34/position = Vector3(-1.11482e-08, 0.213436, -2.50942e-15)
bones/34/rotation = Quaternion(-1.05796e-07, 0.391084, 0.920355, -2.58643e-08)
bones/35/position = Vector3(-6.31128e-09, 0.16565, 2.70695e-09)
bones/35/rotation = Quaternion(-0.391084, -6.73931e-08, -6.22002e-08, 0.920355)
bones/36/rotation = Quaternion(1, 3.76526e-09, 1.94879e-07, 7.45058e-09)
bones/37/rotation = Quaternion(1.00614e-16, -6.74098e-17, -1.57416e-08, 1)
bones/38/position = Vector3(0.839842, 0.719866, -0.447558)
bones/38/rotation = Quaternion(-0.707107, -7.27951e-08, -7.27951e-08, 0.707107)
bones/39/position = Vector3(0.339729, 0.818401, 0.412805)
bones/39/rotation = Quaternion(0.611846, 0.0640472, 0.465299, 0.636427)
bones/39/scale = Vector3(1, 1, 1)
bones/40/position = Vector3(-0.87741, 1.03555, -0.447559)
bones/40/rotation = Quaternion(-0.707107, -7.27951e-08, -7.27951e-08, 0.707107)
bones/41/position = Vector3(-0.335004, 0.82588, 0.274458)
bones/41/rotation = Quaternion(-0.330753, 0.224688, 0.90319, -0.156094)

[node name="Skeleton_Mage_Hat" parent="CharacterBody3D/skeleton_mage/Rig/Skeleton3D" index="0"]
transform = Transform3D(1, -2.98023e-08, -5.81145e-07, -1.11759e-08, 0.998739, -0.050199, 5.66244e-07, 0.050199, 0.998739, 0.0290276, 1.75099, -0.048634)

[node name="Area3D" type="Area3D" parent="CharacterBody3D/skeleton_mage/Rig" index="1" groups=["enemies"]]

[node name="CollisionShape3D" type="CollisionShape3D" parent="CharacterBody3D/skeleton_mage/Rig/Area3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.21607, 0)
shape = SubResource("CapsuleShape3D_3eyau")

[node name="AnimationPlayer" parent="CharacterBody3D/skeleton_mage" index="1"]
autoplay = "Idle"

[node name="SubViewport" type="SubViewport" parent="CharacterBody3D/skeleton_mage"]
transparent_bg = true
handle_input_locally = false
size = Vector2i(256, 256)
render_target_update_mode = 4

[node name="ProgressBar" type="ProgressBar" parent="CharacterBody3D/skeleton_mage/SubViewport"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -64.0
offset_top = -9.0
offset_right = 64.0
offset_bottom = 9.0
grow_horizontal = 2
grow_vertical = 2
theme_override_styles/fill = SubResource("StyleBoxFlat_lkm61")
script = ExtResource("3_qiyck")

[node name="Sprite3D" type="Sprite3D" parent="CharacterBody3D/skeleton_mage"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.032, 0)
billboard = 1
texture = SubResource("ViewportTexture_iq34d")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="CharacterBody3D/skeleton_mage"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="CharacterBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.18579, 0.156)
shape = SubResource("CapsuleShape3D_qiyck")

[node name="RayCast3D" type="RayCast3D" parent="CharacterBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.813268, 0)
target_position = Vector3(0, 0, 10)

[connection signal="area_entered" from="CharacterBody3D/skeleton_mage/Rig/Area3D" to="." method="_on_area_3d_area_entered"]
[connection signal="animation_finished" from="CharacterBody3D/skeleton_mage/AnimationPlayer" to="CharacterBody3D" method="_on_animation_player_animation_finished"]
[connection signal="value_changed" from="CharacterBody3D/skeleton_mage/SubViewport/ProgressBar" to="CharacterBody3D/skeleton_mage/SubViewport/ProgressBar" method="_on_value_changed"]

[editable path="CharacterBody3D/skeleton_mage"]
